/**
 * gridstack.js 1.0.0-dev
 * http://troolee.github.io/gridstack.js/
 * (c) 2014-2017 Pavel Reznikov, Dylan Weiss
 * gridstack.js may be freely distributed under the MIT license.
 * @preserve
*/
!function(n){if("function"==typeof define&&define.amd)define(["jquery","lodash"],n);else if("undefined"!=typeof exports){try{jQuery=require("jquery")}catch(n){}try{_=require("lodash")}catch(n){}n(jQuery,_)}else n(jQuery,_)}(function(n,t){function e(n){this.grid=n}var s=window,u=function(n,t,i){var r=function(){return console.warn("gridstack.js: Function `"+t+"` is deprecated as of v0.2.5 and has been replaced with `"+i+"`. It will be **completely** removed in v1.0."),n.apply(this,arguments)};return r.prototype=n.prototype,r},o=function(n,t){console.warn("gridstack.js: Option `"+n+"` is deprecated as of v0.2.5 and has been replaced with `"+t+"`. It will be **completely** removed in v1.0.")},f={isIntercepted:function(n,t){return!(n.x+n.width<=t.x||t.x+t.width<=n.x||n.y+n.height<=t.y||t.y+t.height<=n.y)},sort:function(n,i,r){return r=r||t.chain(n).map(function(n){return n.x+n.width}).max().value(),i=-1!=i?1:-1,t.sortBy(n,function(n){return i*(n.x+n.y*r)})},createStylesheet:function(n){var t=document.createElement("style");return t.setAttribute("type","text/css"),t.setAttribute("data-gs-style-id",n),t.styleSheet?t.styleSheet.cssText="":t.appendChild(document.createTextNode("")),document.getElementsByTagName("head")[0].appendChild(t),t.sheet},removeStylesheet:function(t){n("STYLE[data-gs-style-id="+t+"]").remove()},insertCSSRule:function(n,t,i,r){"function"==typeof n.insertRule?n.insertRule(t+"{"+i+"}",r):"function"==typeof n.addRule&&n.addRule(t,i,r)},toBool:function(n){return"boolean"==typeof n?n:"string"==typeof n?!(""===(n=n.toLowerCase())||"no"==n||"false"==n||"0"==n):Boolean(n)},_collisionNodeCheck:function(n){return n!=this.node&&f.isIntercepted(n,this.nn)},_didCollide:function(n){return f.isIntercepted({x:this.n.x,y:this.newY,width:this.n.width,height:this.n.height},n)},_isAddNodeIntercepted:function(n){return f.isIntercepted({x:this.x,y:this.y,width:this.node.width,height:this.node.height},n)},parseHeight:function(n){var i=n,u="px",r;if(i&&t.isString(i)){if(r=i.match(/^(-[0-9]+\.[0-9]+|[0-9]*\.[0-9]+|-[0-9]+|[0-9]+)(px|em|rem|vh|vw)?$/),!r)throw new Error("Invalid height");u=r[2]||"px";i=parseFloat(r[1])}return{height:i,unit:u}}},h,r,i;return f.is_intercepted=u(f.isIntercepted,"is_intercepted","isIntercepted"),f.create_stylesheet=u(f.createStylesheet,"create_stylesheet","createStylesheet"),f.remove_stylesheet=u(f.removeStylesheet,"remove_stylesheet","removeStylesheet"),f.insert_css_rule=u(f.insertCSSRule,"insert_css_rule","insertCSSRule"),e.registeredPlugins=[],e.registerPlugin=function(n){e.registeredPlugins.push(n)},e.prototype.resizable=function(){return this},e.prototype.draggable=function(){return this},e.prototype.droppable=function(){return this},e.prototype.isDroppable=function(){return!1},e.prototype.on=function(){return this},h=0,r=function(n,t,i,r,u){this.width=n;this.float=i||!1;this.height=r||0;this.nodes=u||[];this.onchange=t||function(){};this._updateCounter=0;this._float=this.float;this._addedNodes=[];this._removedNodes=[]},r.prototype.batchUpdate=function(){this._updateCounter=1;this.float=!0},r.prototype.commit=function(){0!==this._updateCounter&&(this._updateCounter=0,this.float=this._float,this._packNodes(),this._notify())},r.prototype.getNodeDataByDOMEl=function(n){return t.find(this.nodes,function(t){return n.get(0)===t.el.get(0)})},r.prototype._fixCollisions=function(n){var r,u,i;for(this._sortNodes(-1),r=n,u=Boolean(t.find(this.nodes,function(n){return n.locked})),this.float||u||(r={x:0,y:n.y,width:this.width,height:n.height});;){if(i=t.find(this.nodes,t.bind(f._collisionNodeCheck,{node:n,nn:r})),void 0===i)return;this.moveNode(i,i.x,n.y+n.height,i.width,i.height,!0)}},r.prototype.isAreaEmpty=function(n,i,r,u){var o={x:n||0,y:i||0,width:r||1,height:u||1},e=t.find(this.nodes,t.bind(function(n){return f.isIntercepted(n,o)},this));return null===e||void 0===e},r.prototype._sortNodes=function(n){this.nodes=f.sort(this.nodes,n,this.width)},r.prototype._packNodes=function(){this._sortNodes();this.float?t.each(this.nodes,t.bind(function(n){var i,r;if(!n._updating&&void 0!==n._origY&&n.y!=n._origY)for(i=n.y;i>=n._origY;)r=t.chain(this.nodes).find(t.bind(f._didCollide,{n:n,newY:i})).value(),r||(n._dirty=!0,n.y=i),--i},this)):t.each(this.nodes,t.bind(function(n,i){var r,u,e;if(!n.locked)for(;n.y>0;){if(r=n.y-1,u=0===i,i>0&&(e=t.chain(this.nodes).take(i).find(t.bind(f._didCollide,{n:n,newY:r})).value(),u=void 0===e),!u)break;n._dirty=n.y!=r;n.y=r}},this))},r.prototype._prepareNode=function(n,i){return n=t.defaults(n||{},{width:1,height:1,x:0,y:0}),n.x=parseInt(""+n.x),n.y=parseInt(""+n.y),n.width=parseInt(""+n.width),n.height=parseInt(""+n.height),n.autoPosition=n.autoPosition||!1,n.noResize=n.noResize||!1,n.noMove=n.noMove||!1,n.width>this.width?n.width=this.width:n.width<1&&(n.width=1),n.height<1&&(n.height=1),n.x<0&&(n.x=0),n.x+n.width>this.width&&(i?n.width=this.width-n.x:n.x=this.width-n.width),n.y<0&&(n.y=0),n},r.prototype._notify=function(){var n=Array.prototype.slice.call(arguments,0),t;if(n[0]=void 0===n[0]?[]:[n[0]],n[1]=void 0===n[1]||n[1],!this._updateCounter){t=n[0].concat(this.getDirtyNodes());this.onchange(t,n[1])}},r.prototype.cleanNodes=function(){this._updateCounter||t.each(this.nodes,function(n){n._dirty=!1})},r.prototype.getDirtyNodes=function(){return t.filter(this.nodes,function(n){return n._dirty})},r.prototype.addNode=function(n,i){var r,u,e;if(n=this._prepareNode(n),void 0!==n.maxWidth&&(n.width=Math.min(n.width,n.maxWidth)),void 0!==n.maxHeight&&(n.height=Math.min(n.height,n.maxHeight)),void 0!==n.minWidth&&(n.width=Math.max(n.width,n.minWidth)),void 0!==n.minHeight&&(n.height=Math.max(n.height,n.minHeight)),n._id=++h,n._dirty=!0,n.autoPosition)for(this._sortNodes(),r=0;;++r)if(u=r%this.width,e=Math.floor(r/this.width),!(u+n.width>this.width)&&!t.find(this.nodes,t.bind(f._isAddNodeIntercepted,{x:u,y:e,node:n}))){n.x=u;n.y=e;break}return this.nodes.push(n),void 0!==i&&i&&this._addedNodes.push(t.clone(n)),this._fixCollisions(n),this._packNodes(),this._notify(),n},r.prototype.removeNode=function(n,i){i=void 0===i||i;this._removedNodes.push(t.clone(n));n._id=null;this.nodes=t.without(this.nodes,n);this._packNodes();this._notify(n,i)},r.prototype.canMoveNode=function(i,u,f,e,o){var l,s,h,c;return this.isNodeChangedPosition(i,u,f,e,o)?(l=Boolean(t.find(this.nodes,function(n){return n.locked})),!this.height&&!l)?!0:(h=new r(this.width,null,this.float,0,t.map(this.nodes,function(t){return t==i?s=n.extend({},t):n.extend({},t)})),void 0===s)?!0:(h.moveNode(s,u,f,e,o),c=!0,l&&(c&=!Boolean(t.find(h.nodes,function(n){return n!=s&&Boolean(n.locked)&&Boolean(n._dirty)}))),this.height&&(c&=h.getGridHeight()<=this.height),c):!1},r.prototype.canBePlacedWithRespectToHeight=function(i){if(!this.height)return!0;var u=new r(this.width,null,this.float,0,t.map(this.nodes,function(t){return n.extend({},t)}));return u.addNode(i),u.getGridHeight()<=this.height},r.prototype.isNodeChangedPosition=function(n,t,i,r,u){return"number"!=typeof t&&(t=n.x),"number"!=typeof i&&(i=n.y),"number"!=typeof r&&(r=n.width),"number"!=typeof u&&(u=n.height),void 0!==n.maxWidth&&(r=Math.min(r,n.maxWidth)),void 0!==n.maxHeight&&(u=Math.min(u,n.maxHeight)),void 0!==n.minWidth&&(r=Math.max(r,n.minWidth)),void 0!==n.minHeight&&(u=Math.max(u,n.minHeight)),n.x!=t||n.y!=i||n.width!=r||n.height!=u},r.prototype.moveNode=function(n,t,i,r,u,f){if(!this.isNodeChangedPosition(n,t,i,r,u)||("number"!=typeof t&&(t=n.x),"number"!=typeof i&&(i=n.y),"number"!=typeof r&&(r=n.width),"number"!=typeof u&&(u=n.height),void 0!==n.maxWidth&&(r=Math.min(r,n.maxWidth)),void 0!==n.maxHeight&&(u=Math.min(u,n.maxHeight)),void 0!==n.minWidth&&(r=Math.max(r,n.minWidth)),void 0!==n.minHeight&&(u=Math.max(u,n.minHeight)),n.x==t&&n.y==i&&n.width==r&&n.height==u))return n;var e=n.width!=r;return n._dirty=!0,n.x=t,n.y=i,n.width=r,n.height=u,n.lastTriedX=t,n.lastTriedY=i,n.lastTriedWidth=r,n.lastTriedHeight=u,n=this._prepareNode(n,e),this._fixCollisions(n),f||(this._packNodes(),this._notify()),n},r.prototype.getGridHeight=function(){return t.reduce(this.nodes,function(n,t){return Math.max(n,t.y+t.height)},0)},r.prototype.beginUpdate=function(n){t.each(this.nodes,function(n){n._origY=n.y});n._updating=!0},r.prototype.endUpdate=function(){t.each(this.nodes,function(n){n._origY=n.y});var n=t.find(this.nodes,function(n){return n._updating});n&&(n._updating=!1)},i=function(i,u){var c,l,f=this,a,v,p,s,y,h;if(u=u||{},this.container=n(i),void 0!==u.handle_class&&(u.handleClass=u.handle_class,o("handle_class","handleClass")),void 0!==u.item_class&&(u.itemClass=u.item_class,o("item_class","itemClass")),void 0!==u.placeholder_class&&(u.placeholderClass=u.placeholder_class,o("placeholder_class","placeholderClass")),void 0!==u.placeholder_text&&(u.placeholderText=u.placeholder_text,o("placeholder_text","placeholderText")),void 0!==u.cell_height&&(u.cellHeight=u.cell_height,o("cell_height","cellHeight")),void 0!==u.vertical_margin&&(u.verticalMargin=u.vertical_margin,o("vertical_margin","verticalMargin")),void 0!==u.min_width&&(u.minWidth=u.min_width,o("min_width","minWidth")),void 0!==u.static_grid&&(u.staticGrid=u.static_grid,o("static_grid","staticGrid")),void 0!==u.is_nested&&(u.isNested=u.is_nested,o("is_nested","isNested")),void 0!==u.always_show_resize_handle&&(u.alwaysShowResizeHandle=u.always_show_resize_handle,o("always_show_resize_handle","alwaysShowResizeHandle")),u.itemClass=u.itemClass||"grid-stack-item",a=this.container.closest("."+u.itemClass).length>0,(this.opts=t.defaults(u||{},{width:parseInt(this.container.attr("data-gs-width"))||12,height:parseInt(this.container.attr("data-gs-height"))||0,itemClass:"grid-stack-item",placeholderClass:"grid-stack-placeholder",placeholderText:"",handle:".grid-stack-item-content",handleClass:null,cellHeight:60,verticalMargin:20,auto:!0,minWidth:768,float:!1,staticGrid:!1,_class:"grid-stack-instance-"+(1e4*Math.random()).toFixed(0),animate:Boolean(this.container.attr("data-gs-animate"))||!1,alwaysShowResizeHandle:u.alwaysShowResizeHandle||!1,resizable:t.defaults(u.resizable||{},{autoHide:!u.alwaysShowResizeHandle,handles:"se"}),draggable:t.defaults(u.draggable||{},{handle:(u.handleClass?"."+u.handleClass:u.handle?u.handle:"")||".grid-stack-item-content",scroll:!1,appendTo:"body"}),disableDrag:u.disableDrag||!1,disableResize:u.disableResize||!1,rtl:"auto",removable:!1,removeTimeout:2e3,verticalMarginUnit:"px",cellHeightUnit:"px",disableOneColumnMode:u.disableOneColumnMode||!1,oneColumnModeClass:u.oneColumnModeClass||"grid-stack-one-column-mode",ddPlugin:null}),!1===this.opts.ddPlugin?this.opts.ddPlugin=e:null===this.opts.ddPlugin&&(this.opts.ddPlugin=t.first(e.registeredPlugins)||e),this.dd=new this.opts.ddPlugin(this),"auto"===this.opts.rtl&&(this.opts.rtl="rtl"===this.container.css("direction")),this.opts.rtl&&this.container.addClass("grid-stack-rtl"),this.opts.isNested=a,l="auto"===this.opts.cellHeight,l?f.cellHeight(f.cellWidth(),!0):this.cellHeight(this.opts.cellHeight,!0),this.verticalMargin(this.opts.verticalMargin,!0),this.container.addClass(this.opts._class),this._setStaticClass(),a&&this.container.addClass("grid-stack-nested"),this._initStyles(),this.grid=new r(this.opts.width,function(n,i){i=void 0===i||i;var r=0;t.each(n,function(n){i&&null===n._id?n.el&&n.el.remove():(n.el.attr("data-gs-x",n.x).attr("data-gs-y",n.y).attr("data-gs-width",n.width).attr("data-gs-height",n.height),r=Math.max(r,n.y+n.height))});f._updateStyles(r+10)},this.opts.float,this.opts.height),this.opts.auto)&&(v=[],p=this,this.container.children("."+this.opts.itemClass+":not(."+this.opts.placeholderClass+")").each(function(t,i){i=n(i);v.push({el:i,i:parseInt(i.attr("data-gs-x"))+parseInt(i.attr("data-gs-y"))*p.opts.width})}),t.chain(v).sortBy(function(n){return n.i}).each(function(n){f._prepareElement(n.el)}).value()),(this.setAnimation(this.opts.animate),this.placeholder=n('<div class="'+this.opts.placeholderClass+" "+this.opts.itemClass+'"><div class="placeholder-content">'+this.opts.placeholderText+"<\/div><\/div>").hide(),this._updateContainerHeight(),this._updateHeightsOnResize=t.throttle(function(){f.cellHeight(f.cellWidth(),!1)},100),this.onResizeHandler=function(){if(l&&f._updateHeightsOnResize(),f._isOneColumnMode()&&!f.opts.disableOneColumnMode){if(c)return;f.container.addClass(f.opts.oneColumnModeClass);c=!0;f.grid._sortNodes();t.each(f.grid.nodes,function(n){f.container.append(n.el);f.opts.staticGrid||(f.dd.draggable(n.el,"disable"),f.dd.resizable(n.el,"disable"),n.el.trigger("resize"))})}else{if(!c)return;if(f.container.removeClass(f.opts.oneColumnModeClass),c=!1,f.opts.staticGrid)return;t.each(f.grid.nodes,function(n){n.noMove||f.opts.disableDrag||f.dd.draggable(n.el,"enable");n.noResize||f.opts.disableResize||f.dd.resizable(n.el,"enable");n.el.trigger("resize")})}},n(window).resize(this.onResizeHandler),this.onResizeHandler(),f.opts.staticGrid||"string"!=typeof f.opts.removable)||(s=n(f.opts.removable),this.dd.isDroppable(s)||this.dd.droppable(s,{accept:"."+f.opts.itemClass}),this.dd.on(s,"dropover",function(t,i){var r=n(i.draggable);r.data("_gridstack_node")._grid===f&&f._setupRemovingTimeout(r)}).on(s,"dropout",function(t,i){var r=n(i.draggable);r.data("_gridstack_node")._grid===f&&f._clearRemovingTimeout(r)})),!f.opts.staticGrid&&f.opts.acceptWidgets){y=null;h=function(n,t){var e=y,i=e.data("_gridstack_node"),o=f.getCellFromPixel(t.offset,!0),r=Math.max(0,o.x),u=Math.max(0,o.y);if(i._added){if(!f.grid.canMoveNode(i,r,u))return;f.grid.moveNode(i,r,u);f._updateContainerHeight()}else i._added=!0,i.el=e,i.x=r,i.y=u,f.grid.cleanNodes(),f.grid.beginUpdate(i),f.grid.addNode(i),f.container.append(f.placeholder),f.placeholder.attr("data-gs-x",i.x).attr("data-gs-y",i.y).attr("data-gs-width",i.width).attr("data-gs-height",i.height).show(),i.el=f.placeholder,i._beforeDragX=i.x,i._beforeDragY=i.y,f._updateContainerHeight()};this.dd.droppable(f.container,{accept:function(t){t=n(t);var i=t.data("_gridstack_node");return(!i||i._grid!==f)&&t.is(!0===f.opts.acceptWidgets?".grid-stack-item":f.opts.acceptWidgets)}}).on(f.container,"dropover",function(t,i){var r=(f.container.offset(),n(i.draggable)),o=f.cellWidth(),s=f.cellHeight(),u=r.data("_gridstack_node"),c=u?u.width:Math.ceil(r.outerWidth()/o),l=u?u.height:Math.ceil(r.outerHeight()/s),e;y=r;e=f.grid._prepareNode({width:c,height:l,_added:!1,_temporary:!0});r.data("_gridstack_node",e);r.data("_gridstack_node_orig",u);r.on("drag",h)}).on(f.container,"dropout",function(t,i){var r=n(i.draggable),u;r.data("_gridstack_node")&&(r.unbind("drag",h),u=r.data("_gridstack_node"),u.el=null,f.grid.removeNode(u),f.placeholder.detach(),f._updateContainerHeight(),r.data("_gridstack_node",r.data("_gridstack_node_orig")))}).on(f.container,"drop",function(t,i){var r,u,e;f.placeholder.detach();r=n(i.draggable).data("_gridstack_node");r._grid=f;u=n(i.draggable).clone(!1);u.data("_gridstack_node",r);e=n(i.draggable).data("_gridstack_node_orig");void 0!==e&&void 0!==e._grid&&e._grid._triggerRemoveEvent();n(i.helper).remove();r.el=u;f.placeholder.hide();u.attr("data-gs-x",r.x).attr("data-gs-y",r.y).attr("data-gs-width",r.width).attr("data-gs-height",r.height).addClass(f.opts.itemClass).removeAttr("style").enableSelection().removeData("draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled").unbind("drag",h);f.container.append(u);f._prepareElementsByNode(u,r);f._updateContainerHeight();f.grid._addedNodes.push(r);f._triggerAddEvent();f._triggerChangeEvent();f.grid.endUpdate();n(i.draggable).unbind("drag",h);n(i.draggable).removeData("_gridstack_node");n(i.draggable).removeData("_gridstack_node_orig")})}},i.prototype._triggerChangeEvent=function(n){var t=this.grid.getDirtyNodes(),i=!1,r=[];t&&t.length&&(r.push(t),i=!0);(i||!0===n)&&this.container.trigger("change",r)},i.prototype._triggerAddEvent=function(){this.grid._addedNodes&&this.grid._addedNodes.length>0&&(this.container.trigger("added",[t.map(this.grid._addedNodes,t.clone)]),this.grid._addedNodes=[])},i.prototype._triggerRemoveEvent=function(){this.grid._removedNodes&&this.grid._removedNodes.length>0&&(this.container.trigger("removed",[t.map(this.grid._removedNodes,t.clone)]),this.grid._removedNodes=[])},i.prototype._initStyles=function(){this._stylesId&&f.removeStylesheet(this._stylesId);this._stylesId="gridstack-style-"+(1e5*Math.random()).toFixed();this._styles=f.createStylesheet(this._stylesId);null!==this._styles&&(this._styles._max=0)},i.prototype._updateStyles=function(n){var r,u,i,t;if(null!==this._styles&&void 0!==this._styles&&(u="."+this.opts._class+" ."+this.opts.itemClass,i=this,void 0===n&&(n=this._styles._max),this._initStyles(),this._updateContainerHeight(),this.opts.cellHeight&&!(0!==this._styles._max&&n<=this._styles._max)&&(r=this.opts.verticalMargin&&this.opts.cellHeightUnit!==this.opts.verticalMarginUnit?function(n,t){return n&&t?"calc("+(i.opts.cellHeight*n+i.opts.cellHeightUnit)+" + "+(i.opts.verticalMargin*t+i.opts.verticalMarginUnit)+")":i.opts.cellHeight*n+i.opts.verticalMargin*t+i.opts.cellHeightUnit}:function(n,t){return i.opts.cellHeight*n+i.opts.verticalMargin*t+i.opts.cellHeightUnit},0===this._styles._max&&f.insertCSSRule(this._styles,u,"min-height: "+r(1,0)+";",0),n>this._styles._max))){for(t=this._styles._max;t<n;++t)f.insertCSSRule(this._styles,u+'[data-gs-height="'+(t+1)+'"]',"height: "+r(t+1,t)+";",t),f.insertCSSRule(this._styles,u+'[data-gs-min-height="'+(t+1)+'"]',"min-height: "+r(t+1,t)+";",t),f.insertCSSRule(this._styles,u+'[data-gs-max-height="'+(t+1)+'"]',"max-height: "+r(t+1,t)+";",t),f.insertCSSRule(this._styles,u+'[data-gs-y="'+t+'"]',"top: "+r(t,t)+";",t);this._styles._max=n}},i.prototype._updateContainerHeight=function(){if(!this.grid._updateCounter){var n=this.grid.getGridHeight();this.container.attr("data-gs-current-height",n);this.opts.cellHeight&&(this.opts.verticalMargin?this.opts.cellHeightUnit===this.opts.verticalMarginUnit?this.container.css("height",n*(this.opts.cellHeight+this.opts.verticalMargin)-this.opts.verticalMargin+this.opts.cellHeightUnit):this.container.css("height","calc("+(n*this.opts.cellHeight+this.opts.cellHeightUnit)+" + "+(n*(this.opts.verticalMargin-1)+this.opts.verticalMarginUnit)+")"):this.container.css("height",n*this.opts.cellHeight+this.opts.cellHeightUnit))}},i.prototype._isOneColumnMode=function(){return(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)<=this.opts.minWidth},i.prototype._setupRemovingTimeout=function(t){var r=this,i=n(t).data("_gridstack_node");!i._removeTimeout&&r.opts.removable&&(i._removeTimeout=setTimeout(function(){t.addClass("grid-stack-item-removing");i._isAboutToRemove=!0},r.opts.removeTimeout))},i.prototype._clearRemovingTimeout=function(t){var i=n(t).data("_gridstack_node");i._removeTimeout&&(clearTimeout(i._removeTimeout),i._removeTimeout=null,t.removeClass("grid-stack-item-removing"),i._isAboutToRemove=!1)},i.prototype._prepareElementsByNode=function(t,i){var u,f,r=this,e=function(n,e){var h,c,o=Math.round(e.position.left/u),s=Math.floor((e.position.top+f/2)/f),l,a;if("drag"!=n.type&&(h=Math.round(e.size.width/u),c=Math.round(e.size.height/f)),"drag"==n.type)o<0||o>=r.grid.width||s<0||!r.grid.float&&s>r.grid.getGridHeight()?i._temporaryRemoved||(!0===r.opts.removable&&r._setupRemovingTimeout(t),o=i._beforeDragX,s=i._beforeDragY,r.placeholder.detach(),r.placeholder.hide(),r.grid.removeNode(i),r._updateContainerHeight(),i._temporaryRemoved=!0):(r._clearRemovingTimeout(t),i._temporaryRemoved&&(r.grid.addNode(i),r.placeholder.attr("data-gs-x",o).attr("data-gs-y",s).attr("data-gs-width",h).attr("data-gs-height",c).show(),r.container.append(r.placeholder),i.el=r.placeholder,i._temporaryRemoved=!1));else if("resize"==n.type&&o<0)return;l=void 0!==h?h:i.lastTriedWidth;a=void 0!==c?c:i.lastTriedHeight;r.grid.canMoveNode(i,o,s,h,c)&&(i.lastTriedX!==o||i.lastTriedY!==s||i.lastTriedWidth!==l||i.lastTriedHeight!==a)&&(i.lastTriedX=o,i.lastTriedY=s,i.lastTriedWidth=h,i.lastTriedHeight=c,r.grid.moveNode(i,o,s,h,c),r._updateContainerHeight())},o=function(e){var o,s;r.container.append(r.placeholder);o=n(this);r.grid.cleanNodes();r.grid.beginUpdate(i);u=r.cellWidth();s=Math.ceil(o.outerHeight()/o.attr("data-gs-height"));f=r.container.height()/parseInt(r.container.attr("data-gs-current-height"));r.placeholder.attr("data-gs-x",o.attr("data-gs-x")).attr("data-gs-y",o.attr("data-gs-y")).attr("data-gs-width",o.attr("data-gs-width")).attr("data-gs-height",o.attr("data-gs-height")).show();i.el=r.placeholder;i._beforeDragX=i.x;i._beforeDragY=i.y;r.dd.resizable(t,"option","minWidth",u*(i.minWidth||1));r.dd.resizable(t,"option","minHeight",s*(i.minHeight||1));"resizestart"==e.type&&o.find(".grid-stack-item").trigger("resizestart")},s=function(u){var f=n(this),e,o;f.data("_gridstack_node")&&(e=!1,(r.placeholder.detach(),i.el=f,r.placeholder.hide(),i._isAboutToRemove)?(e=!0,t.data("_gridstack_node")._grid._triggerRemoveEvent(),t.removeData("_gridstack_node"),t.remove()):(r._clearRemovingTimeout(t),i._temporaryRemoved?(f.attr("data-gs-x",i._beforeDragX).attr("data-gs-y",i._beforeDragY).attr("data-gs-width",i.width).attr("data-gs-height",i.height).removeAttr("style"),i.x=i._beforeDragX,i.y=i._beforeDragY,r.grid.addNode(i)):f.attr("data-gs-x",i.x).attr("data-gs-y",i.y).attr("data-gs-width",i.width).attr("data-gs-height",i.height).removeAttr("style")),r._updateContainerHeight(),r._triggerChangeEvent(e),r.grid.endUpdate(),o=f.find(".grid-stack"),o.length&&"resizestop"==u.type&&(o.each(function(t,i){n(i).data("gridstack").onResizeHandler()}),f.find(".grid-stack-item").trigger("resizestop"),f.find(".grid-stack-item").trigger("gsresizestop")),"resizestop"==u.type&&r.container.trigger("gsresizestop",f))};this.dd.draggable(t,{start:o,stop:s,drag:e}).resizable(t,{start:o,stop:s,resize:e});(i.noMove||this._isOneColumnMode()&&!r.opts.disableOneColumnMode||this.opts.disableDrag)&&this.dd.draggable(t,"disable");(i.noResize||this._isOneColumnMode()&&!r.opts.disableOneColumnMode||this.opts.disableResize)&&this.dd.resizable(t,"disable");t.attr("data-gs-locked",i.locked?"yes":null)},i.prototype._prepareElement=function(t,i){var r,u;i=void 0!==i&&i;r=this;t=n(t);t.addClass(this.opts.itemClass);u=r.grid.addNode({x:t.attr("data-gs-x"),y:t.attr("data-gs-y"),width:t.attr("data-gs-width"),height:t.attr("data-gs-height"),maxWidth:t.attr("data-gs-max-width"),minWidth:t.attr("data-gs-min-width"),maxHeight:t.attr("data-gs-max-height"),minHeight:t.attr("data-gs-min-height"),autoPosition:f.toBool(t.attr("data-gs-auto-position")),noResize:f.toBool(t.attr("data-gs-no-resize")),noMove:f.toBool(t.attr("data-gs-no-move")),locked:f.toBool(t.attr("data-gs-locked")),resizeHandles:t.attr("data-gs-resize-handles"),el:t,id:t.attr("data-gs-id"),_grid:r},i);t.data("_gridstack_node",u);this._prepareElementsByNode(t,u)},i.prototype.setAnimation=function(n){n?this.container.addClass("grid-stack-animate"):this.container.removeClass("grid-stack-animate")},i.prototype.addWidget=function(t,i,r,u,f,e,o,s,h,c,l){return t=n(t),void 0!==i&&t.attr("data-gs-x",i),void 0!==r&&t.attr("data-gs-y",r),void 0!==u&&t.attr("data-gs-width",u),void 0!==f&&t.attr("data-gs-height",f),void 0!==e&&t.attr("data-gs-auto-position",e?"yes":null),void 0!==o&&t.attr("data-gs-min-width",o),void 0!==s&&t.attr("data-gs-max-width",s),void 0!==h&&t.attr("data-gs-min-height",h),void 0!==c&&t.attr("data-gs-max-height",c),void 0!==l&&t.attr("data-gs-id",l),this.container.append(t),this._prepareElement(t,!0),this._triggerAddEvent(),this._updateContainerHeight(),this._triggerChangeEvent(!0),t},i.prototype.makeWidget=function(t){return t=n(t),this._prepareElement(t,!0),this._triggerAddEvent(),this._updateContainerHeight(),this._triggerChangeEvent(!0),t},i.prototype.willItFit=function(n,t,i,r,u){var f={x:n,y:t,width:i,height:r,autoPosition:u};return this.grid.canBePlacedWithRespectToHeight(f)},i.prototype.removeWidget=function(t,i){i=void 0===i||i;t=n(t);var r=t.data("_gridstack_node");r||(r=this.grid.getNodeDataByDOMEl(t));this.grid.removeNode(r,i);t.removeData("_gridstack_node");this._updateContainerHeight();i&&t.remove();this._triggerChangeEvent(!0);this._triggerRemoveEvent()},i.prototype.removeAll=function(n){t.each(this.grid.nodes,t.bind(function(t){this.removeWidget(t.el,n)},this));this.grid.nodes=[];this._updateContainerHeight()},i.prototype.destroy=function(t){n(window).off("resize",this.onResizeHandler);this.disable();void 0===t||t?this.container.remove():(this.removeAll(!1),this.container.removeData("gridstack"));f.removeStylesheet(this._stylesId);this.grid&&(this.grid=null)},i.prototype.resizable=function(t,i){var r=this;return t=n(t),t.each(function(t,u){u=n(u);var f=u.data("_gridstack_node");void 0!==f&&null!==f&&(f.noResize=!i,f.noResize||r._isOneColumnMode()&&!r.opts.disableOneColumnMode?r.dd.resizable(u,"disable"):r.dd.resizable(u,"enable"))}),this},i.prototype.movable=function(t,i){var r=this;return t=n(t),t.each(function(t,u){u=n(u);var f=u.data("_gridstack_node");void 0!==f&&null!==f&&(f.noMove=!i,f.noMove||r._isOneColumnMode()&&!r.opts.disableOneColumnMode?(r.dd.draggable(u,"disable"),u.removeClass("ui-draggable-handle")):(r.dd.draggable(u,"enable"),u.addClass("ui-draggable-handle")))}),this},i.prototype.enableMove=function(n,t){this.movable(this.container.children("."+this.opts.itemClass),n);t&&(this.opts.disableDrag=!n)},i.prototype.enableResize=function(n,t){this.resizable(this.container.children("."+this.opts.itemClass),n);t&&(this.opts.disableResize=!n)},i.prototype.disable=function(){this.movable(this.container.children("."+this.opts.itemClass),!1);this.resizable(this.container.children("."+this.opts.itemClass),!1);this.container.trigger("disable")},i.prototype.enable=function(){this.movable(this.container.children("."+this.opts.itemClass),!0);this.resizable(this.container.children("."+this.opts.itemClass),!0);this.container.trigger("enable")},i.prototype.locked=function(t,i){return t=n(t),t.each(function(t,r){r=n(r);var u=r.data("_gridstack_node");void 0!==u&&null!==u&&(u.locked=i||!1,r.attr("data-gs-locked",u.locked?"yes":null))}),this},i.prototype.maxHeight=function(t,i){return t=n(t),t.each(function(t,r){r=n(r);var u=r.data("_gridstack_node");void 0!==u&&null!==u&&(isNaN(i)||(u.maxHeight=i||!1,r.attr("data-gs-max-height",i)))}),this},i.prototype.minHeight=function(t,i){return t=n(t),t.each(function(t,r){r=n(r);var u=r.data("_gridstack_node");void 0!==u&&null!==u&&(isNaN(i)||(u.minHeight=i||!1,r.attr("data-gs-min-height",i)))}),this},i.prototype.maxWidth=function(t,i){return t=n(t),t.each(function(t,r){r=n(r);var u=r.data("_gridstack_node");void 0!==u&&null!==u&&(isNaN(i)||(u.maxWidth=i||!1,r.attr("data-gs-max-width",i)))}),this},i.prototype.minWidth=function(t,i){return t=n(t),t.each(function(t,r){r=n(r);var u=r.data("_gridstack_node");void 0!==u&&null!==u&&(isNaN(i)||(u.minWidth=i||!1,r.attr("data-gs-min-width",i)))}),this},i.prototype._updateElement=function(t,i){var u,r;t=n(t).first();u=t.data("_gridstack_node");void 0!==u&&null!==u&&(r=this,r.grid.cleanNodes(),r.grid.beginUpdate(u),i.call(this,t,u),r._updateContainerHeight(),r._triggerChangeEvent(),r.grid.endUpdate())},i.prototype.resize=function(n,t,i){this._updateElement(n,function(n,r){t=null!==t&&void 0!==t?t:r.width;i=null!==i&&void 0!==i?i:r.height;this.grid.moveNode(r,r.x,r.y,t,i)})},i.prototype.move=function(n,t,i){this._updateElement(n,function(n,r){t=null!==t&&void 0!==t?t:r.x;i=null!==i&&void 0!==i?i:r.y;this.grid.moveNode(r,t,i,r.width,r.height)})},i.prototype.update=function(n,t,i,r,u){this._updateElement(n,function(n,f){t=null!==t&&void 0!==t?t:f.x;i=null!==i&&void 0!==i?i:f.y;r=null!==r&&void 0!==r?r:f.width;u=null!==u&&void 0!==u?u:f.height;this.grid.moveNode(f,t,i,r,u)})},i.prototype.verticalMargin=function(n,t){if(void 0===n)return this.opts.verticalMargin;var i=f.parseHeight(n);this.opts.verticalMarginUnit===i.unit&&this.opts.height===i.height||(this.opts.verticalMarginUnit=i.unit,this.opts.verticalMargin=i.height,t||this._updateStyles())},i.prototype.cellHeight=function(n,t){var r,i;if(void 0===n)return this.opts.cellHeight?this.opts.cellHeight:(r=this.container.children("."+this.opts.itemClass).first(),Math.ceil(r.outerHeight()/r.attr("data-gs-height")));i=f.parseHeight(n);this.opts.cellHeightUnit===i.heightUnit&&this.opts.height===i.height||(this.opts.cellHeightUnit=i.unit,this.opts.cellHeight=i.height,t||this._updateStyles())},i.prototype.cellWidth=function(){return Math.round(this.container.outerWidth()/this.opts.width)},i.prototype.getCellFromPixel=function(n,t){var i=void 0!==t&&t?this.container.offset():this.container.position(),r=n.left-i.left,u=n.top-i.top,f=Math.floor(this.container.width()/this.opts.width),e=Math.floor(this.container.height()/parseInt(this.container.attr("data-gs-current-height")));return{x:Math.floor(r/f),y:Math.floor(u/e)}},i.prototype.batchUpdate=function(){this.grid.batchUpdate()},i.prototype.commit=function(){this.grid.commit();this._updateContainerHeight()},i.prototype.isAreaEmpty=function(n,t,i,r){return this.grid.isAreaEmpty(n,t,i,r)},i.prototype.setStatic=function(n){this.opts.staticGrid=!0===n;this.enableMove(!n);this.enableResize(!n);this._setStaticClass()},i.prototype._setStaticClass=function(){!0===this.opts.staticGrid?this.container.addClass("grid-stack-static"):this.container.removeClass("grid-stack-static")},i.prototype._updateNodeWidths=function(n,t){this.grid._sortNodes();this.grid.batchUpdate();for(var i={},r=0;r<this.grid.nodes.length;r++)i=this.grid.nodes[r],this.update(i.el,Math.round(i.x*t/n),void 0,Math.round(i.width*t/n),void 0);this.grid.commit()},i.prototype.setGridWidth=function(n,t){this.container.removeClass("grid-stack-"+this.opts.width);!0!==t&&this._updateNodeWidths(this.opts.width,n);this.opts.width=n;this.grid.width=n;this.container.addClass("grid-stack-"+n)},r.prototype.batch_update=u(r.prototype.batchUpdate),r.prototype._fix_collisions=u(r.prototype._fixCollisions,"_fix_collisions","_fixCollisions"),r.prototype.is_area_empty=u(r.prototype.isAreaEmpty,"is_area_empty","isAreaEmpty"),r.prototype._sort_nodes=u(r.prototype._sortNodes,"_sort_nodes","_sortNodes"),r.prototype._pack_nodes=u(r.prototype._packNodes,"_pack_nodes","_packNodes"),r.prototype._prepare_node=u(r.prototype._prepareNode,"_prepare_node","_prepareNode"),r.prototype.clean_nodes=u(r.prototype.cleanNodes,"clean_nodes","cleanNodes"),r.prototype.get_dirty_nodes=u(r.prototype.getDirtyNodes,"get_dirty_nodes","getDirtyNodes"),r.prototype.add_node=u(r.prototype.addNode,"add_node","addNode, "),r.prototype.remove_node=u(r.prototype.removeNode,"remove_node","removeNode"),r.prototype.can_move_node=u(r.prototype.canMoveNode,"can_move_node","canMoveNode"),r.prototype.move_node=u(r.prototype.moveNode,"move_node","moveNode"),r.prototype.get_grid_height=u(r.prototype.getGridHeight,"get_grid_height","getGridHeight"),r.prototype.begin_update=u(r.prototype.beginUpdate,"begin_update","beginUpdate"),r.prototype.end_update=u(r.prototype.endUpdate,"end_update","endUpdate"),r.prototype.can_be_placed_with_respect_to_height=u(r.prototype.canBePlacedWithRespectToHeight,"can_be_placed_with_respect_to_height","canBePlacedWithRespectToHeight"),i.prototype._trigger_change_event=u(i.prototype._triggerChangeEvent,"_trigger_change_event","_triggerChangeEvent"),i.prototype._init_styles=u(i.prototype._initStyles,"_init_styles","_initStyles"),i.prototype._update_styles=u(i.prototype._updateStyles,"_update_styles","_updateStyles"),i.prototype._update_container_height=u(i.prototype._updateContainerHeight,"_update_container_height","_updateContainerHeight"),i.prototype._is_one_column_mode=u(i.prototype._isOneColumnMode,"_is_one_column_mode","_isOneColumnMode"),i.prototype._prepare_element=u(i.prototype._prepareElement,"_prepare_element","_prepareElement"),i.prototype.set_animation=u(i.prototype.setAnimation,"set_animation","setAnimation"),i.prototype.add_widget=u(i.prototype.addWidget,"add_widget","addWidget"),i.prototype.make_widget=u(i.prototype.makeWidget,"make_widget","makeWidget"),i.prototype.will_it_fit=u(i.prototype.willItFit,"will_it_fit","willItFit"),i.prototype.remove_widget=u(i.prototype.removeWidget,"remove_widget","removeWidget"),i.prototype.remove_all=u(i.prototype.removeAll,"remove_all","removeAll"),i.prototype.min_height=u(i.prototype.minHeight,"min_height","minHeight"),i.prototype.min_width=u(i.prototype.minWidth,"min_width","minWidth"),i.prototype._update_element=u(i.prototype._updateElement,"_update_element","_updateElement"),i.prototype.cell_height=u(i.prototype.cellHeight,"cell_height","cellHeight"),i.prototype.cell_width=u(i.prototype.cellWidth,"cell_width","cellWidth"),i.prototype.get_cell_from_pixel=u(i.prototype.getCellFromPixel,"get_cell_from_pixel","getCellFromPixel"),i.prototype.batch_update=u(i.prototype.batchUpdate,"batch_update","batchUpdate"),i.prototype.is_area_empty=u(i.prototype.isAreaEmpty,"is_area_empty","isAreaEmpty"),i.prototype.set_static=u(i.prototype.setStatic,"set_static","setStatic"),i.prototype._set_static_class=u(i.prototype._setStaticClass,"_set_static_class","_setStaticClass"),s.GridStackUI=i,s.GridStackUI.Utils=f,s.GridStackUI.Engine=r,s.GridStackUI.GridStackDragDropPlugin=e,n.fn.gridstack=function(t){return this.each(function(){var r=n(this);r.data("gridstack")||r.data("gridstack",new i(this,t))})},s.GridStackUI}),function(n){if("function"==typeof define&&define.amd)define(["jquery","lodash","gridstack","jquery-ui/data","jquery-ui/disable-selection","jquery-ui/focusable","jquery-ui/form","jquery-ui/ie","jquery-ui/keycode","jquery-ui/labels","jquery-ui/jquery-1-7","jquery-ui/plugin","jquery-ui/safe-active-element","jquery-ui/safe-blur","jquery-ui/scroll-parent","jquery-ui/tabbable","jquery-ui/unique-id","jquery-ui/version","jquery-ui/widget","jquery-ui/widgets/mouse","jquery-ui/widgets/draggable","jquery-ui/widgets/droppable","jquery-ui/widgets/resizable"],n);else if("undefined"!=typeof exports){try{jQuery=require("jquery")}catch(n){}try{_=require("lodash")}catch(n){}try{GridStackUI=require("gridstack")}catch(n){}n(jQuery,_,GridStackUI)}else n(jQuery,_,GridStackUI)}(function(n,t,i){function r(n){i.GridStackDragDropPlugin.call(this,n)}return window,i.GridStackDragDropPlugin.registerPlugin(r),r.prototype=Object.create(i.GridStackDragDropPlugin.prototype),r.prototype.constructor=r,r.prototype.resizable=function(i,r){var u,f,e;return(i=n(i),"disable"===r||"enable"===r)?i.resizable(r):"option"===r?(u=arguments[2],f=arguments[3],i.resizable(r,u,f)):(e=i.data("gs-resize-handles")?i.data("gs-resize-handles"):this.grid.opts.resizable.handles,i.resizable(t.extend({},this.grid.opts.resizable,{handles:e},{start:r.start||function(){},stop:r.stop||function(){},resize:r.resize||function(){}}))),this},r.prototype.draggable=function(i,r){return i=n(i),"disable"===r||"enable"===r?i.draggable(r):i.draggable(t.extend({},this.grid.opts.draggable,{containment:this.grid.opts.isNested?this.grid.container.parent():null,start:r.start||function(){},stop:r.stop||function(){},drag:r.drag||function(){}})),this},r.prototype.droppable=function(t,i){return t=n(t),"disable"===i||"enable"===i?t.droppable(i):t.droppable({accept:i.accept}),this},r.prototype.isDroppable=function(t){return t=n(t),Boolean(t.data("droppable"))},r.prototype.on=function(t,i,r){return n(t).on(i,r),this},r});